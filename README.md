# マイ・プログレスバー ![GitHub release (latest SemVer)](https://img.shields.io/github/v/release/YUZURANIUM/01_mypb?style=plastic) ![GitHub release (latest SemVer including pre-releases)](https://img.shields.io/github/v/release/YUZURANIUM/01_mypb?include_prereleases&style=plastic)

## 特徴（feature）

* `user32.as` や `gdi32.as`、`hsp3util.as` 等を必要とせず、本モジュールのみでプログレスバーを設置可能。

* 現在位置や状態等のプログレスバーに関する情報の取得は全て関数で行うため、式の中で利用可能。

* 内部で、オブジェクトの設置には `winobj 命令`、それ以外の命令･関数は `sendmsg 命令` を使用。

## 使用方法（how to use）

## 機能（function）

<details open>

<summary>追加される命令･関数</summary>

~~~hsp
;---------------------------------------
;オブジェクトの設置
;---------------------------------------

// プログレスバーの設置（命令・マクロ）
// p1,p2 : Xサイズ, Yサイズ
// p3    : オブジェクトハンドルを受け取る変数
// p4(0) : スタイル(0 = 通常, 1 = 垂直, 2 = マーキー, 3 = 垂直マーキー)
    mypb X, Y, Objhwnd, style


;---------------------------------------
;オブジェクトの設定
;---------------------------------------

// プログレスバーの設定（命令・マクロ）
// p1     : オブジェクトハンドル
// p2(0)  : 最小値(int)
// p3(10) : 最大値(int)
// p4(1)  : 1ステップ当たりの変化量(+/-int)
// p5(0)  : 現在位置(int)
    pbset objhwnd, min, Max, delta, now


;---------------------------------------
;プログレスバーの実行
;---------------------------------------

// 設定した変化量だけ進める（命令）
// p1 : オブジェクトハンドル
    pbstep objhwnd


;---------------------------------------
;現在位置
;---------------------------------------

// プログレスバーの位置設定（命令・マクロ）
// p1    : オブジェクトハンドル
// p2    : 新しく設定する位置(int)
// p3(0) : 設定フラグ(0 = 絶対位置, 1 = 相対位置)
    pbsetpos objhwnd, newpos, flag


// プログレスバーの現在位置取得（関数）
// p1 : オブジェクトハンドル
// 戻り値 : stat
    pbgetp objhwnd


;---------------------------------------
;プログレスバーの状態
;---------------------------------------

// プログレスバーの状態設定（命令）
// p1 : オブジェクトハンドル
// p2 : バーの状態
//  1 = PBST_NORMAL (緑色)
//  2 = PBST_ERROR  (赤色)
//  3 = PBST_PAUSED (黄色)
    pbsetst objhwnd, status


// プログレスバーの状態取得（関数）
// p1 : オブジェクトハンドル
// 戻り値 : stat
//        1 = PBST_NORMAL (緑色)
//        2 = PBST_ERROR  (赤色)
//        3 = PBST_PAUSED (黄色)
    pbgetst objhwnd


// プログレスバーの現在位置監視（命令・マクロ）
// p1     : オブジェクトハンドル
// p2(25) : 中間域の下限値(int)
// p3(40) : 中間域の上限値(int)
// p4(2)  : 下位域の状態 (PBST_ERROR  (赤色))
// p5(3)  : 中間域の状態 (PBST_PAUSED (黄色))
// p6(1)  : 上位域の状態 (PBST_NORMAL (緑色))
    pbsetst2 objhwnd, under, higher, p4, p5, p6
    ;
    ;（※補足）
    ;ループ内に置くことで現在位置に応じたバーの状態（色）に変更する。
    ;初期値では
    ;       25未満  PBST_ERROR  (赤色)
    ;25以上,40以下  PBST_PAUSED (黄色)
    ;       40超過  PBST_NORMAL (緑色)

;---------------------------------------
;マーキーの操作
;---------------------------------------

// マーキーの操作（命令・マクロ）
// p1     : オブジェクトハンドル
// p2     : マーキー(0 = 停止, 1 = 再生)
// p3(30) : アニメーション更新間隔(ms)
    pbmarq objhwnd, p2, p3
    ;
    ;（※補足）
    ;ループ内に置く必要なし
    ;
    ;第２パラメータに変数を指定し、その変数に 0 または 1 を渡して下さい
    ;buttonやlayerobj等のラベルジャンプ先に置いて使用して下さい

~~~

</details>


## 必要環境

* Windows11
* HSP3.6以上


## 使用言語（Coding Language）

![HSP version](https://img.shields.io/badge/Hot%20Soup%20Processor-3.7beta3-orange&?link=https://hsp.tv/right)


## 開発環境（Development environment）

* Windows11 Pro 22H2 x64
* Visual Studio Code
* Hot Soup Processor.37beta3

## LICENSE

本ソフトウェアおよび関連文書のファイル（以下「ソフトウェア」）の複製を取得するすべての人に対し、ソフトウェアを無制限に扱うことを無償で許可します。

これには、ソフトウェアの複製を使用、複写、変更、結合、掲載、頒布、サブライセンス、および/または販売する権利、およびソフトウェアを提供する相手に同じことを許可する権利も無制限に含まれます。


ソフトウェアは「現状のまま」で、明示であるか暗黙であるかを問わず、何らの保証もなく提供されます。ここでいう保証とは、商品性、特定の目的への適合性、および権利非侵害についての保証も含みますが、それに限定されるものではありません。

作者または著作権者は、契約行為、不法行為、またはそれ以外であろうと、ソフトウェアに起因または関連し、あるいはソフトウェアの使用またはその他の扱いによって生じる一切の請求、損害、その他の義務について何らの責任も負わないものとします。

